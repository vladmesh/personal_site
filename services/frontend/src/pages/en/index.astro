---
import BaseLayout from '@layouts/BaseLayout.astro';
import Hero from '@components/Hero.astro';
import HomeSections from '@components/HomeSections.astro';
import { projects } from '@data/projects';
import { skillGroups } from '@data/skills';
import { testimonials } from '@data/testimonials';
import { buildHomeCopy } from '@data/home';
import { links } from '@data/links';
import { fetchContacts, getTelegramHandle, selectContact } from '@lib/profile/contacts';

const lang = 'en';
const pageProjects = projects[lang];
const contacts = await fetchContacts(lang);
const telegram = selectContact(contacts, ['telegram']);
const email = selectContact(contacts, ['email']);
const primaryContact = selectContact(contacts, ['telegram', 'email']);
const content = buildHomeCopy(lang, {
  emailHref: email?.href ?? links.email,
  emailText: email?.display ?? links.emailPlain,
  telegramHref: telegram?.href ?? links.telegram,
  telegramHandle: getTelegramHandle(telegram) ?? `@${links.telegram.split('/').filter(Boolean).pop() ?? ''}`,
  primaryContactHref: primaryContact?.href ?? links.telegram
});
---
<BaseLayout
  title="Vlad â€” Backend & AI Engineer"
  description="Backend engineering, AI agents, and consulting portfolio. Resume, selected projects, and contact links."
  lang={lang}
  ogImage="/og/home_en.png"
  contacts={contacts}
>
  <Hero lang={lang} content={content.hero} />
  <HomeSections
    lang={lang}
    content={content}
    projects={pageProjects}
    skills={skillGroups}
    quotes={testimonials}
  />
</BaseLayout>

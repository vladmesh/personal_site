---
import type { ContactsResult } from '@lib/profile/contacts';
const { contacts } = Astro.props as { contacts?: ContactsResult };
const allowedTypes = ['email', 'telegram', 'whatsapp', 'linkedin', 'phone'];
const contactItems = (contacts?.items ?? []).filter((item) => allowedTypes.includes(item.type));
---
<dialog id="contact-modal" class="fixed inset-0 z-50 m-0 h-full w-full bg-black/60 p-0 hidden" aria-modal="true" aria-labelledby="contact-title">
  <div class="absolute inset-0 flex items-center justify-center p-4">
    <div class="w-full max-w-sm rounded-2xl border border-white/10 bg-slate-900 p-6 shadow-xl">
      <div class="flex items-center justify-between">
        <h2 id="contact-title" class="text-xl font-semibold text-white">Contact</h2>
        <button type="button" class="rounded-md p-1 text-slate-400 hover:text-white" aria-label="Close" onclick="window.closeContactModal && window.closeContactModal()">
          Ã—
        </button>
      </div>
      <div class="mt-4 grid grid-cols-5 gap-3">
        {contactItems
          .filter((contact) => contact.isVisible !== false)
          .map((contact) => {
            const target = contact.href.startsWith('http') ? '_blank' : undefined;
            const rel = target ? 'noreferrer' : undefined;
            return (
              <a
                href={contact.href}
                target={target}
                rel={rel}
                class="group flex aspect-square items-center justify-center rounded-xl border border-white/10 bg-white/5 hover:border-white/30"
                aria-label={contact.label}
              >
                {contact.type === 'email' ? (
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6 text-slate-200 opacity-90 group-hover:opacity-100"><path d="M1.5 6.75A2.25 2.25 0 0 1 3.75 4.5h16.5A2.25 2.25 0 0 1 22.5 6.75v10.5A2.25 2.25 0 0 1 20.25 19.5H3.75A2.25 2.25 0 0 1 1.5 17.25V6.75Zm2.838-.75a.75.75 0 0 0-.588 1.227l7.162 8.589a.75.75 0 0 0 1.174 0l7.162-8.589a.75.75 0 0 0-.588-1.227H4.338Z"/></svg>
                ) : contact.type === 'telegram' ? (
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6 text-slate-200 opacity-90 group-hover:opacity-100"><path d="M9.036 15.803 8.87 19.5c.32 0 .46-.137.627-.3l3.006-2.876 4.966 3.635c.91.503 1.559.238 1.803-.84l3.266-15.31.001-.001c.29-1.348-.487-1.872-1.373-1.544L1.114 9.25c-1.316.511-1.296 1.246-.224 1.576l6.153 1.918L19.2 5.956c.6-.394 1.146-.176.697.218"/></svg>
                ) : contact.type === 'whatsapp' ? (
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6 text-slate-200 opacity-90 group-hover:opacity-100"><path d="M20.52 3.48A11.94 11.94 0 0 0 12.06 0C5.4 0 .01 5.39.01 12.06c0 2.125.56 4.163 1.62 5.98L0 24l6.128-1.606a11.96 11.96 0 0 0 5.932 1.6h.006c6.66 0 12.05-5.388 12.054-12.046A11.94 11.94 0 0 0 20.52 3.48ZM12.06 21.5h-.005a9.43 9.43 0 0 1-4.8-1.32l-.345-.205-3.64.955.974-3.55-.224-.364a9.42 9.42 0 0 1-1.45-5.05c0-5.204 4.234-9.438 9.44-9.438 2.523 0 4.893.983 6.676 2.77a9.38 9.38 0 0 1 2.763 6.67c-.004 5.202-4.238 9.436-9.444 9.436Zm5.47-7.07c-.3-.15-1.77-.87-2.044-.966-.273-.1-.472-.15-.67.15-.2.3-.77.97-.943 1.17-.17.2-.35.225-.65.075-.298-.15-1.26-.46-2.403-1.47-.888-.79-1.49-1.76-1.664-2.06-.173-.3-.018-.46.13-.61.134-.133.3-.35.45-.525.15-.176.2-.3.3-.5.1-.2.05-.375-.025-.525-.075-.15-.67-1.61-.92-2.2-.24-.576-.485-.5-.67-.51l-.57-.01c-.2 0-.525.075-.8.375-.273.3-1.04 1.02-1.04 2.48 0 1.46 1.065 2.87 1.213 3.07.15.2 2.098 3.2 5.083 4.49.71.31 1.26.5 1.69.64.71.226 1.36.194 1.87.118.57-.085 1.77-.72 2.02-1.42.25-.7.25-1.3.175-1.42-.075-.12-.275-.2-.575-.35Z"/></svg>
                ) : contact.type === 'linkedin' ? (
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6 text-slate-200 opacity-90 group-hover:opacity-100"><path d="M4.98 3.5C4.98 4.88 3.88 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1s2.48 1.12 2.48 2.5zM.5 8.5h4V24h-4V8.5zm7.5 0h3.8v2.1h.1c.5-1 1.8-2.1 3.7-2.1C20.7 8.5 24 11.3 24 16.2V24h-4v-6.9c0-1.6-.03-3.6-2.2-3.6-2.2 0-2.5 1.7-2.5 3.5V24h-4V8.5z"/></svg>
                ) : contact.type === 'phone' ? (
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6 text-slate-200 opacity-90 group-hover:opacity-100"><path d="M6.62 10.79a15.56 15.56 0 0 0 6.59 6.59l2.2-2.2a1 1 0 0 1 1.01-.24 11.36 11.36 0 0 0 3.56.57 1 1 0 0 1 1 1V20a1 1 0 0 1-1 1C10.07 21 3 13.93 3 5a1 1 0 0 1 1-1h3.5a1 1 0 0 1 1 1c0 1.22.2 2.41.57 3.56a1 1 0 0 1-.24 1.01l-2.2 2.22Z"/></svg>
                ) : (
                  <span class="text-xs font-medium text-slate-200">{contact.label}</span>
                )}
              </a>
            );
          })}
      </div>
    </div>
  </div>
</dialog>
